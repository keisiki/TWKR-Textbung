@WINDY_PANCHIRA

;デフォルトの確率は25%
LOCAL = 25

;時止め中だと発生しない
SIF FLAG:70
	RETURN 0

;あなた一人だけだと発生しない
SIF TARGET <= 0
	RETURN 0

;対象が睡眠中だと発生しない
SIF CFLAG:수면
	RETURN 0

;屋外（屋根の有無は問わない）でないと発生しない
SIF !OUTROOF(CFLAG:MASTER:현재위치) && INROOM(CFLAG:MASTER:현재위치)
	RETURN 0

;地底以外だと晴れか曇りでないと発生しない
SIF GET_MAPID(CFLAG:MASTER:현재위치) != 9 && !(TIME:5 >= 0 && TIME:5 <= 3) 
	RETURN 0

;地底以外で台風、および吹雪だと発生しない
SIF GET_MAPID(CFLAG:MASTER:현재위치) != 9 && GROUPMATCH(FLAG:이상기상, 9, 10)
	RETURN 0

;会話、仕事を手伝う、自由行動に付き合う、休憩、掃除、戦闘訓練、待つのいずれかでないと発生しない
SIF !(SELECTCOM == 300 || SELECTCOM == 304 || SELECTCOM == 368 || SELECTCOM == 403 || SELECTCOM == 410 || SELECTCOM == 411 || SELECTCOM == 440)
	RETURN 0

;一部の自由行動では発生しない
IF SELECTCOM == 368
	SELECTCASE Activity_Type:TARGET
	CASE 2,3,7,11,13,15,16,18
		RETURN 0
	ENDSELECT
ENDIF

;一度発生したら5ターンのクールタイムあり
SIF FLAG:바람치라CT > 0
	RETURN 0

;暴風以上だとパンツどころではないので発生しない
SIF WIND_VELOCITY >= 2
	RETURN 0

;妖怪の山（山頂）だと発生確率上昇
SIF GET_MAPID(CFLAG:MASTER:현재위치) == 8
	LOCAL += 10

;地底以外で強風だと発生確率上昇
SIF WIND_VELOCITY == 1 && GET_MAPID(CFLAG:MASTER:현재위치) != 9
	LOCAL += 10

$LOOP
IF RAND:2 == 0
	SIF EQUIP:TARGET:바지
		RETURN 0
	SIF !(EQUIP:TARGET:치마 || EQUIP:TARGET:원피스 || EQUIP:TARGET:기모노) || EQUIP:TARGET:0 == 0
		RETURN 0
	;기모노だと発生確率低下
	SIF !(EQUIP:TARGET:치마 || EQUIP:TARGET:원피스) && EQUIP:TARGET:기모노
		LOCAL -= 10
	;데이트중だと発生確率低下
	SIF CHK_DATENOW(CFLAG:TARGET:데이트중)
		LOCAL -= 10
	IF RAND:100 < LOCAL + CFLAG:TARGET:넘김보정
		CALL PANCHIRA
	ELSE
		RETURN 0		
	ENDIF
ELSE
	SIF EQUIP:MASTER:바지
		RETURN 0
	SIF !(EQUIP:MASTER:치마 || EQUIP:MASTER:원피스 || EQUIP:MASTER:기모노) || EQUIP:MASTER:0 == 0
		RETURN 0
	SIF !(EQUIP:MASTER:치마 || EQUIP:MASTER:원피스) && EQUIP:MASTER:기모노
		LOCAL -= 10
	SIF CHK_DATENOW(CFLAG:TARGET:데이트중)
		LOCAL -= 10
	IF RAND:100 < LOCAL
		CALL REV_PANCHIRA
	ELSE
		RETURN 0		
	ENDIF
ENDIF
RETURN 1

@PANCHIRA
DRAWLINE
IF GET_MAPID(CFLAG:MASTER:현재위치) != 9 && WIND_VELOCITY == 1
	PRINTFORM 때마침 불어오는 강풍이 갑자기 기세를 올려 긴장을 풀고있던 %CALLNAME:TARGET%의
ELSE
	PRINTFORM 갑작스럽게 불어온 바람이 방심하고 있던 %CALLNAME:TARGET%의
ENDIF
IF EQUIP:TARGET:치마
	PRINTFORM %조사처리(SHOW_BOTTOM(TARGET,1), "를")%
ELSEIF EQUIP:TARGET:기모노
	PRINTFORM %SHOW_TOP(TARGET,1)% 자락을
ELSEIF EQUIP:TARGET:원피스
	PRINTFORM %SHOW_TOP(TARGET,2)% 자락을
ENDIF
;PRINTFORM を
SIF GET_MAPID(CFLAG:MASTER:현재위치) != 9 && WIND_VELOCITY == 1
	PRINTFORM 성대하게 
PRINTFORML 걷어올렸다
 
PRINTFORM %CALLNAME:TARGET%

SELECTCASE SELECTCOM

CASE 300
	PRINTFORM %조사만처리(CALLNAME:TARGET,"과")% 가까이서 이야기 하고있던
CASE 304
	IF CFLAG:TARGET:350 == 46
		PRINTFORM 의 놀이에 참가하고 있었던
	ELSE
		PRINTFORM 의 일을 돕고 있었던
	ENDIF
CASE 368
	SELECTCASE Activity_Type:TARGET
	CASE 0
		PRINTFORM 의 생각에 대해 질문하고 있었던
	CASE 1
		PRINTFORM 의 놀이에 어울리고 있었던
	CASE 4
		PRINTFORM 의 청소를 돕고 있었던
	CASE 5
		PRINTFORM 의 운동에 어울리고 있었던
	CASE 6
		PRINTFORM %조사만처리(CALLNAME:TARGET,"가")% 읽고 있는 책에 대해 질문하고 있었던
	CASE 8
		IF TFLAG:193 == -2
			SELECTCASE TALENT:TARGET:음악지식
			CASE 1
				PRINTFORM 의 연주를 듣고 있었던
			CASE 2
				PRINTFORM 의 노래를 듣고 있었던
			CASE 3
				PRINTFORM 의 춤을 보고 있었던
			ENDSELECT
		ELSE
			SELECTCASE TALENT:TARGET:음악지식
			CASE 1
				PRINTFORM 의 연주에 맞춰 세션하고 있었던
			CASE 2
				PRINTFORM 의 노래에 맞춰 반주하고 있었던
			CASE 3
				PRINTFORM 의 춤에 맞춰 반춰 반주하고 있었던
			ENDSELECT
		ENDIF
	CASE 9
		PRINTFORM 의 채집을 돕고 있었던
	CASE 10
		IF TFLAG:193 < 0
			PRINTFORM %조사만처리(CALLNAME:TARGET,"가")% 낚시를 하는걸 보고 있었던
		ELSE
			PRINTFORM 의 옆에서 낚시를 하고 있었던
		ENDIF
	CASE 12
		PRINTFORM %조사만처리(CALLNAME:TARGET,"과")% 함께 느긋하게 있었던
	CASE 14
		PRINTFORM 의 쇼핑을 돕고 있었던
	CASE 17
		PRINTFORM %조사만처리(CALLNAME:TARGET,"가")% 눈으로 만드는걸 돕고 있었던
	ENDSELECT
CASE 403
	PRINTFORM %조사만처리(CALLNAME:TARGET,"과")% 함께 숨을 돌리고 있었던
CASE 410
	IF TFLAG:193
		PRINTFORM %조사만처리(CALLNAME:TARGET,"과")% 함께 청소를 하고 있었던
	ELSE
		PRINTFORM %조사만처리(CALLNAME:TARGET,"가")% 보는 앞에서 청소를 하고있었던
	ENDIF
CASE 411
	PRINTFORM %조사만처리(CALLNAME:TARGET,"과")% 함께 훈련을 하고 있었던
CASE 440
	IF CHK_DATENOW(CFLAG:TARGET:데이트중)
		PRINTFORM %조사만처리(CALLNAME:TARGET,"과")% 함께 행동하고 있었던
	ELSE
		PRINTFORM 의 근처에 마침 있었던
	ENDIF

ENDSELECT
PRINTFORML %마스터는%, 

IF EQUIP:TARGET:치마
	PRINTFORM %SHOW_BOTTOM(TARGET,1)%
ELSEIF EQUIP:TARGET:기모노
	PRINTFORM %SHOW_TOP(TARGET,1)%
ELSEIF EQUIP:TARGET:원피스
	PRINTFORM %SHOW_TOP(TARGET,2)%
ENDIF

PRINTFORM 에 숨겨진

IF !EQUIP:TARGET:하반신속옷2
	PRINTFORM 맨살인 하반신을
ELSE
	PRINTFORM %PANTS_DESCRIPTION(EQUIP:TARGET:하반신속옷2, TARGET)% %조사처리(PANTSNAME(EQUIP:TARGET:하반신속옷2, TARGET),"를")%
ENDIF
PRINTL  확실히 보고 말았다…
WAIT

CALL KOJO_MESSAGE_SEND("PANCHIRA",0,TARGET)
CALL PANCHIRA_SOURCE

RETURN 1


@REV_PANCHIRA
DRAWLINE
IF GET_MAPID(CFLAG:MASTER:현재위치) != 9 && WIND_VELOCITY == 1
	PRINTFORM 때마침 불어오는 강풍이 갑자기 기세를 올려 긴장을 풀고있던 %마스터는%
ELSE
	PRINTFORM 갑자기 발밑에서 일은 장난스러운 바람에 방심하고 있던 %마스터는%
ENDIF
IF EQUIP:MASTER:치마
	PRINTFORM %조사처리(SHOW_BOTTOM(MASTER,1),"를")%
ELSEIF EQUIP:MASTER:기모노
	PRINTFORM %SHOW_TOP(MASTER,1)%의 자락을
ELSEIF EQUIP:MASTER:원피스
	PRINTFORM %SHOW_TOP(MASTER,2)%의 자락을
ENDIF
;PRINTFORM を
SIF GET_MAPID(CFLAG:MASTER:현재위치) != 9 && WIND_VELOCITY == 1
	PRINTFORM 성대하게

PRINTFORM 걷어올려져 

IF SELECTCOM == 368 && Activity_Type:TARGET == 10 && RAND:2 == 0
	PRINTFORML 버렸지만, 
	PRINTFORM 낚시에 열중하던 %타겟은%, %마스터가% 드러낸 치태를 깨닫지 못한 것 같다…
	WAIT
	FLAG:바람치라CT = 6
	RETURN 0
ELSE
	PRINTFORML 버려, 
ENDIF

IF SELECTCOM == 440
	IF CHK_DATENOW(CFLAG:TARGET:데이트중)
		PRINTFORM 가까이서
	ELSE
		PRINTFORM 우연히
	ENDIF
ENDIF

PRINTFORM %CALLNAME:MASTER%

SELECTCASE SELECTCOM

CASE 300
	PRINTFORM %조사만처리(CALLNAME:MASTER,"과")% 가까이서 이야기 하고있던
CASE 304
	IF CFLAG:TARGET:350 == 46
		PRINTFORM %조사만처리(CALLNAME:MASTER,"를")% 놀자고 꼬시고 있던
	ELSE
		PRINTFORM 의 도움을 받으며 일을 하고 있었던
	ENDIF
CASE 368
	SELECTCASE Activity_Type:TARGET
	CASE 0
		PRINTFORM 의 눈앞에서 생각을 하고 있었던
	CASE 1
		PRINTFORM 의 놀이에 어울리고 있었던
	CASE 4
		PRINTFORM 의 도움을 받으며 청소를 하던
	CASE 5
		PRINTFORM %조사만처리(CALLNAME:MASTER,"과")% 함께 운동을 하고 있었던
	CASE 6
		PRINTFORM 의 눈앞에서 책을 읽던
	CASE 8
		IF TFLAG:193 == -2
			SELECTCASE TALENT:TARGET:음악지식
			CASE 1
				PRINTFORM 의 눈앞에서 연주를 선보이던
			CASE 2
				PRINTFORM 의 눈앞에서 노래를 선보이던
			CASE 3
				PRINTFORM 의 눈앞에서 춤을 선보이던
			ENDSELECT
		ELSE
			SELECTCASE TALENT:TARGET:음악지식
			CASE 1
				PRINTFORM 의 세션에 맞춰 연주를 선보이던
			CASE 2
				PRINTFORM 의 반주에 맞춰 노래를 선보이던
			CASE 3
				PRINTFORM 의 반주에 맞춰 춤을 선보이던
			ENDSELECT
		ENDIF
	CASE 9
		PRINTFORM 의 도움을 받으며 채집을 하던
	CASE 10
		IF TFLAG:193 < 0
			PRINTFORM 의 시선을 받으며 낚시를 하던
		ELSE
			PRINTFORM 의 옆에서 낚시를 하고 있었던
		ENDIF
	CASE 12
		PRINTFORM %조사만처리(CALLNAME:MASTER,"과")% 함께 느긋하게 있었던
	CASE 14
		PRINTFORM 의 도움을 받으며 쇼핑을 즐기고 있었던
	CASE 17
		PRINTFORM 의 도움을 받으며 눈으로 만들고 있던
	ENDSELECT
CASE 403
	PRINTFORM %조사만처리(CALLNAME:MASTER,"과")% 함께 한숨 돌리고 있던
CASE 410
	IF TFLAG:193
		PRINTFORM %조사만처리(CALLNAME:MASTER,"과")% 함께 청소를 하던
	ELSE
		PRINTFORM %조사만처리(CALLNAME:MASTER,"가")% 청소하는 모습을 바라보던 
	ENDIF
CASE 411
	PRINTFORM %조사만처리(CALLNAME:MASTER,"과")% 함께 훈련을 하던
CASE 440
	PRINTFORM %조사만처리(CALLNAME:MASTER,"을")% 보고있던
ENDSELECT
PRINTFORML %타겟에게%
IF !EQUIP:MASTER:하반신속옷2
	PRINTFORM 맨살을 드러낸 하반신을
ELSE
	PRINTFORM 입고 있었던 %PANTS_DESCRIPTION(EQUIP:MASTER:하반신속옷2, MASTER)% %조사처리(PANTSNAME(EQUIP:MASTER:하반신속옷2, MASTER),"를")%
ENDIF
PRINTL 확실히 보여져 버렸다…
WAIT

CALL KOJO_MESSAGE_SEND("REV_PANCHIRA",0,TARGET)
CALL REV_PANCHIRA_SOURCE

RETURN 1

@PANCHIRA_SOURCE
IF TALENT:연인
	IF !EQUIP:TARGET:하반신속옷2
		SOURCE:TARGET:사랑 += 600
		SOURCE:TARGET:욕정 += 700
		SOURCE:TARGET:유혹 += 800
		SOURCE:TARGET:노출 += 1000
	ELSE
		SOURCE:TARGET:사랑 += 600
		SOURCE:TARGET:욕정 += 500
		SOURCE:TARGET:유혹 += 500
		SOURCE:TARGET:노출 += 700
	ENDIF
ELSEIF TALENT:연모
	IF !EQUIP:TARGET:하반신속옷2
		SOURCE:TARGET:사랑 += 400
		SOURCE:TARGET:욕정 += 700
		SOURCE:TARGET:유혹 += 800
		SOURCE:TARGET:노출 += 1000
	ELSE
		SOURCE:TARGET:사랑 += 400
		SOURCE:TARGET:욕정 += 500
		SOURCE:TARGET:유혹 += 500
		SOURCE:TARGET:노출 += 700
	ENDIF
ELSEIF TALENT:애욕 || TALENT:섹프
	IF !EQUIP:TARGET:하반신속옷2
		SOURCE:TARGET:욕정 += 600
		SOURCE:TARGET:유혹 += 800
		SOURCE:TARGET:노출 += 1000
	ELSE
		SOURCE:TARGET:욕정 += 400
		SOURCE:TARGET:유혹 += 500
		SOURCE:TARGET:노출 += 700
	ENDIF
ELSEIF TALENT:사모
	IF !EQUIP:TARGET:하반신속옷2
		SOURCE:TARGET:욕정 += 300
		SOURCE:TARGET:유혹 += 400
		SOURCE:TARGET:노출 += 800
		SOURCE:TARGET:일탈 += 10
	ELSE
		SOURCE:TARGET:욕정 += 100
		SOURCE:TARGET:유혹 += 100
		SOURCE:TARGET:노출 += 500
	ENDIF
ELSE
	IF !EQUIP:TARGET:하반신속옷2
		SOURCE:TARGET:노출 += 800
		SOURCE:TARGET:일탈 += 20
		SOURCE:TARGET:반감 += 10
	ELSE
		SOURCE:TARGET:노출 += 500
		SOURCE:TARGET:반감 += 10
	ENDIF
ENDIF

CALL SOURCE_사랑(TARGET)
CALL SOURCE_욕정(TARGET)
CALL SOURCE_유혹(TARGET)
CALL SOURCE_노출(TARGET)
CALL SOURCE_일탈(TARGET)
CALL SOURCE_반감(TARGET)
FLAG:바람치라CT = 6
CFLAG:TARGET:하반신속옷확인 = 1

RETURN 1



@REV_PANCHIRA_SOURCE
IF TALENT:MASTER:성별 == 2
	IF TALENT:연인
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:사랑 += 600
			SOURCE:TARGET:욕정 += 700
			SOURCE:TARGET:환락 += 500
			SOURCE:TARGET:송구스러운 += 600
			SOURCE:MASTER:노출 += 1000
		ELSE
			SOURCE:TARGET:사랑 += 600
			SOURCE:TARGET:욕정 += 300
			SOURCE:TARGET:환락 += 400
			SOURCE:TARGET:송구스러운 += 500
			SOURCE:MASTER:노출 += 700
		ENDIF
	ELSEIF TALENT:연모
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:사랑 += 400
			SOURCE:TARGET:욕정 += 700
			SOURCE:TARGET:환락 += 500
			SOURCE:TARGET:송구스러운 += 600
			SOURCE:MASTER:노출 += 1000
		ELSE
			SOURCE:TARGET:사랑 += 400
			SOURCE:TARGET:욕정 += 300
			SOURCE:TARGET:환락 += 400
			SOURCE:TARGET:송구스러운 += 500
			SOURCE:MASTER:노출 += 700
		ENDIF
	ELSEIF TALENT:애욕 || TALENT:섹프
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:욕정 += 500
			SOURCE:TARGET:환락 += 300
			SOURCE:TARGET:송구스러운 += 400
			SOURCE:MASTER:노출 += 1000
		ELSE
			SOURCE:TARGET:욕정 += 200
			SOURCE:TARGET:환락 += 300
			SOURCE:TARGET:송구스러운 += 300
			SOURCE:MASTER:노출 += 700
		ENDIF
	ELSEIF TALENT:사모
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:욕정 += 100
			SOURCE:TARGET:일탈 += 20
			SOURCE:MASTER:노출 += 800
		ELSE
			SOURCE:TARGET:환락 += 100
			SOURCE:TARGET:송구스러운 += 100
			SOURCE:MASTER:노출 += 500
		ENDIF
	ELSE
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:일탈 += 50
			SOURCE:TARGET:반감 += 50
			SOURCE:MASTER:노출 += 800
		ELSE
			SOURCE:TARGET:환락 += 50
			SOURCE:MASTER:노출 += 500
		ENDIF
	ENDIF
ELSE
	IF TALENT:연인
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:사랑 += 600
			SOURCE:TARGET:욕정 += 700
			SOURCE:TARGET:환락 += 600
			SOURCE:TARGET:송구스러운 += 800
			SOURCE:MASTER:노출 += 1000
		ELSE
			SOURCE:TARGET:사랑 += 600
			SOURCE:TARGET:욕정 += 500
			SOURCE:TARGET:환락 += 500
			SOURCE:TARGET:송구스러운 += 500
			SOURCE:MASTER:노출 += 700
		ENDIF
	ELSEIF TALENT:연모
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:사랑 += 400
			SOURCE:TARGET:욕정 += 700
			SOURCE:TARGET:환락 += 600
			SOURCE:TARGET:송구스러운 += 700
			SOURCE:MASTER:노출 += 1000
		ELSE
			SOURCE:TARGET:사랑 += 400
			SOURCE:TARGET:욕정 += 500
			SOURCE:TARGET:환락 += 500
			SOURCE:TARGET:송구스러운 += 400
			SOURCE:MASTER:노출 += 700
		ENDIF
	ELSEIF TALENT:애욕 || TALENT:섹프
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:욕정 += 600
			SOURCE:TARGET:환락 += 500
			SOURCE:TARGET:송구스러운 += 700
			SOURCE:MASTER:노출 += 1000
		ELSE
			SOURCE:TARGET:욕정 += 400
			SOURCE:TARGET:환락 += 400
			SOURCE:TARGET:송구스러운 += 400
			SOURCE:MASTER:노출 += 700
		ENDIF
	ELSEIF TALENT:사모
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:욕정 += 400
			SOURCE:TARGET:환락 += 200
			SOURCE:TARGET:송구스러운 += 300
			SOURCE:TARGET:일탈 += 10
			SOURCE:MASTER:노출 += 800
		ELSE
			SOURCE:TARGET:욕정 += 400
			SOURCE:TARGET:환락 += 200
			SOURCE:TARGET:송구스러운 += 100
			SOURCE:MASTER:노출 += 500
		ENDIF
	ELSE
		IF !EQUIP:MASTER:하반신속옷2
			SOURCE:TARGET:환락 += 50
			SOURCE:TARGET:일탈 += 10
			SOURCE:MASTER:노출 += 800
		ELSE
			SOURCE:TARGET:환락 += 100
			SOURCE:MASTER:노출 += 500
		ENDIF
	ENDIF
ENDIF

CALL SOURCE_사랑(TARGET)
CALL SOURCE_욕정(TARGET)
CALL SOURCE_환락(TARGET)
CALL SOURCE_송구스러운(TARGET)
CALL SOURCE_일탈(TARGET)
CALL SOURCE_반감(TARGET)
CALL SOURCE_노출(MASTER)
FLAG:바람치라CT = 6

RETURN 1
