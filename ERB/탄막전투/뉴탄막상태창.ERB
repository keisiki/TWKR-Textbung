
@뉴탄막상태창

DRAWLINE
PRINTFORML {T_TIME}턴

DRAWLINE
CALL 뉴탄막상태표시(TARGET)
DRAWLINE
ALIGNMENT CENTER
CALL TBS거리표시
CALL TBS위치관계표시
ALIGNMENT LEFT
DRAWLINE
CALL 뉴탄막상태표시(MASTER)
DRAWLINE

ALIGNMENT LEFT

@BASEPERCENT(ARG,ARGS)
#FUNCTION
#DIM DYNAMIC 백분율
IF ARGS == "체력"
    백분율 = (TCVAR:ARG:T_체력 * 100)/TCVAR:ARG:T_최대체력
ELSEIF ARGS == "TSP"
    IF MAXBASE:ARG:TSP > 0
        백분율 = (BASE:ARG:TSP * 100)/MAXBASE:ARG:TSP
    ELSE
        백분율 = 0
    ENDIF
ENDIF
RETURNF 백분율

@뉴탄막체력BAR(ARG)
#DIM 백분율
#DIM 체력
#DIM 최대체력
;ARG = 대상

백분율 = BASEPERCENT(ARG,"체력")
;색깔 선정
SELECTCASE 백분율
CASE IS >= 70
    SETCOLOR 0x19FF19
CASE IS >= 50
    SETCOLOR 0xFF8000
CASE IS >= 30
    SETCOLOR 0xFFFF00
CASEELSE
    SETCOLOR 0xFF0000
ENDSELECT
;체력바 출력부
PRINTFORM [
REPEAT 백분율
    PRINTFORM *
REND
REPEAT 100 - 백분율
    PRINTFORM .
REND
PRINTFORML ]
RESETCOLOR
PRINTFORM  ({TCVAR:ARG:T_체력}/{TCVAR:ARG:T_최대체력})
IF TB_SUM_VALUE(ARG,TCV_보호)
    SETCOLOR 0x46FFFF
    PRINTFORM +({TB_SUM_VALUE(ARG,TCV_보호)})
    RESETCOLOR
ENDIF
PRINTL
RETURN 0

@뉴탄막TSPBAR
#DIM 백분율
#DIM 체력
#DIM 최대체력
;ARG = 대상

백분율 = (BASE:MASTER:TSP * 10)/MAXBASE:MASTER:TSP
;색깔 선정
SELECTCASE 백분율
CASE IS >= 7
    SETCOLOR 0x19FF19
CASE IS >= 5
    SETCOLOR 0xFF8000
CASE IS >= 3
    SETCOLOR 0xFFFF00
CASEELSE
    SETCOLOR 0xFF0000
ENDSELECT
;체력바 출력부
PRINTFORM [
REPEAT 백분율
    PRINTFORM *
REND
REPEAT 10 - 백분율
    PRINTFORM .
REND
PRINTFORML ]
RESETCOLOR
RETURN 0

@뉴탄막상태표시(ARG)
#DIM 스테이터스, 7
;ARG = 대상

ALIGNMENT CENTER

;화상을 넣을려면 이 사이에
IF ARG == TARGET
    IF FLAG:그림표시&&!탄막전투화상무시
        SIF !TFLAG:LOOK비표시
            PRINTL 　
        CALL PRINT_TARGET_IMAGE(TARGET)
    ELSEIF !FLAG:그림표시
        PRINTFORML [%CALLNAME:ARG%]
    ENDIF
ELSE
    PRINTFORML [%CALLNAME:ARG%]
ENDIF

[IF_DEBUG]
PRINTFORML 통상:{T_행동기회:ARG:T_통상행동}/이동:{T_행동기회:ARG:T_이동행동}

[ENDIF]
;엉성하지만 일단은 만듬

PRINTFORM 체력

CALL 뉴탄막체력BAR(ARG)
IF ARG == MASTER
    PRINTFORM TSP
    CALL 뉴탄막TSPBAR
    PRINTFORM ({BASE:MASTER:TSP}/{MAXBASE:MASTER:TSP})
ENDIF
PRINTL
CALL 상태이상표시(ARG)
PRINTL
PRINTFORM 레벨 : {ABL:ARG:레벨}
PRINTL
PRINTFORM 힘:{TCVAR:ARG:T_힘}
PRINT  
CALL 능력치평가(TCVAR:ARG:T_힘)
PRINT  
PRINTFORM 지성:{TCVAR:ARG:T_지성}
PRINT  
CALL 능력치평가(TCVAR:ARG:T_지성)
PRINT  
PRINTFORM 인내:{TCVAR:ARG:T_인내}
PRINT  
CALL 능력치평가(TCVAR:ARG:T_인내)
PRINT  
PRINTFORM 속도:{TCVAR:ARG:T_속도}
PRINT  
CALL 능력치평가(TCVAR:ARG:T_속도)
PRINT  
PRINTFORM 운:{TCVAR:ARG:T_운}
PRINT  
CALL 능력치평가(TCVAR:ARG:T_운)
PRINT  
PRINTL
PRINTFORM 전투능력 : {ABL:ARG:전투능력}
CALL PRINT_RANK(ABL:ARG:전투능력, "MAX_20")
SELECTCASE ABL:ARG:전투능력
    CASE 0
        PRINT  x1.0
    CASE 1
        PRINT  x1.3
    CASE 2
        PRINT  x1.6
    CASE 3
        PRINT  x1.9
    CASE 4
        PRINT  x2.2
    CASE 5
        PRINT  x2.5
    CASE 6
        PRINT  x2.7
    CASE 7
        PRINT  x2.9
    CASE 8
        PRINT  x3.0
    CASE 9
        PRINT  x3.1
    CASE 10
        PRINT  x3.2
    CASE 11
        PRINT  x3.3
    CASE 12
        PRINT  x3.4
    CASE 13
        PRINT  x3.5
    CASE 14
        PRINT  x3.6
    CASE 15
        PRINT  x3.7
    CASE 16
        PRINT  x3.8
    CASE 17
        PRINT  x3.9
    CASE 18
        PRINT  x4.0
    CASE 19
        PRINT  x4.1
    CASEELSE
        PRINT  x4.5
ENDSELECT
PRINTL
PRINTFORM 공격력 : {TCVAR:ARG:T_공격력}     
PRINTFORM 방어력 : {TCVAR:ARG:T_방어력}
PRINTL
ALIGNMENT LEFT

@능력치평가(ARG)

IF ARG >= 300
    SETCOLOR 0xFF1111
    PRINT P
    SETCOLOR 0x1111FF
    PRINT h
ELSEIF ARG >= 250
    SETCOLOR 0xFA58F4
    PRINT SSS
ELSEIF ARG >= 225
    SETCOLOR 0xFA58F4
    PRINT SS+
ELSEIF ARG >= 200
    SETCOLOR 0xFA58F4
    PRINT SS
ELSEIF ARG >= 180
    SETCOLOR 0xFA58F4
    PRINT SS-
ELSEIF ARG >= 165
    SETCOLOR 0xFA58F4
    PRINT S+
ELSEIF ARG >= 150
    SETCOLOR 0xFF00FF
    PRINT S
ELSEIF ARG >= 135
    SETCOLOR 0x8A0886
    PRINT S-
ELSEIF ARG >= 120
    SETCOLOR 0x0000FF
    PRINT A
ELSEIF ARG >= 110
    SETCOLOR 0x08088A
    PRINT A-
ELSEIF ARG >= 100
    SETCOLOR 0xFA5858
    PRINT B+
ELSEIF ARG >= 90
    SETCOLOR 0xFF0000
    PRINT B
ELSEIF ARG >= 83
    SETCOLOR 0xF3F781
    PRINT C+
ELSEIF ARG >= 65
    SETCOLOR 0xFFFF00
    PRINT C
ELSEIF ARG >= 55
    SETCOLOR 0xAEB404
    PRINT C-
ELSEIF ARG >= 45
    SETCOLOR 0x81DAF5
    PRINT D+
ELSEIF ARG >= 35
    SETCOLOR 0x00BFFF
    PRINT D
ELSEIF ARG >= 25
    SETCOLOR 0x086A87
    PRINT D-
ELSEIF ARG >= 15
    SETCOLOR 0x00FF40
    PRINT E
ELSEIF ARG >= 0
    SETCOLOR 0x848484
    PRINT F
ELSE
    SETCOLOR 0x2E2E2E
    PRINT F-
ENDIF
RESETCOLOR

@상태이상표시(ARG)
;ARG = 대상
;일단 자리만
IF TB_SUM_REMAIN(ARG,TCV_기절) > 0
    SETCOLOR 0xFFD700
    PRINTFORM [기절 {TB_SUM_REMAIN(ARG,TCV_기절)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_집중) > 0
    SETCOLOR 0xFFD700
    PRINTFORM [집중 {TB_SUM_REMAIN(ARG,TCV_집중)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_실명) > 0
    SETCOLOR 0xA9A9A9
    PRINTFORM [실명 {TB_SUM_REMAIN(ARG,TCV_실명)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_침묵) > 0
    SETCOLOR 0x4B0082
    PRINTFORM [침묵 {TB_SUM_REMAIN(ARG,TCV_침묵)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_혼란) > 0
    SETCOLOR 0xFFFF00
    PRINTFORM [혼란 {TB_SUM_REMAIN(ARG,TCV_혼란)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_속박) > 0
    SETCOLOR 0xFFEE00
    PRINTFORM [속박 {TB_SUM_REMAIN(ARG,TCV_속박)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_봉쇄) > 0
    SETCOLOR 0xFFEE00
    PRINTFORM [봉쇄 {TB_SUM_REMAIN(ARG,TCV_봉쇄)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_취약) > 0
    SETCOLOR 0xFF4500
    PRINTFORM [취약 {TB_SUM_VALUE(ARG,TCV_취약)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_힘) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [힘 감소 {TB_SUM_VALUE(ARG,TCV_힘)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_지성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [지성 감소 {TB_SUM_VALUE(ARG,TCV_지성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_속도) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [속도 감소 {TB_SUM_VALUE(ARG,TCV_속도)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_인내) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [인내 감소 {TB_SUM_VALUE(ARG,TCV_인내)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_운) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [운 감소 {TB_SUM_VALUE(ARG,TCV_운)}] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_독) > 0
    SETCOLOR 0x006400
    PRINTFORM [독 x{TB_SUM_VALUE(ARG,TCV_독)}/{TB_SUM_REMAIN(ARG,TCV_독)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_출혈) > 0
    SETCOLOR 0x8B0000
    PRINTFORM [출혈 x{TB_SUM_VALUE(ARG,TCV_출혈)}/{TB_SUM_REMAIN(ARG,TCV_출혈)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_저주) > 0
    SETCOLOR 0xFF0000
    PRINTFORM [저주 {TB_SUM_REMAIN(ARG,TCV_저주)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_화상) > 0
    SETCOLOR 0xFB1111
    PRINTFORM [화상 {TB_SUM_VALUE(ARG,TCV_화상)/TB_SUM_REMAIN(ARG,TCV_화상)}/턴] 
ENDIF
RESETCOLOR
PRINTL
IF TB_SUM_REMAIN(ARG,TCV_면역) > 0
    SETCOLOR 0x00FFFF
    PRINTFORM [면역 {TB_SUM_REMAIN(ARG,TCV_면역)}턴] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_회피) > 0
    SETCOLOR 0x005858
    PRINTFORM [회피 {TB_SUM_VALUE(ARG,TCV_회피)}] 
ENDIF
IF TB_SUM_REMAIN(ARG,TCV_증폭) > 0
    SETCOLOR 0x58FF58
    PRINTFORM [증폭 {TB_SUM_VALUE(ARG,TCV_증폭)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_힘) > 0
    SETCOLOR 0x11FF11
    PRINTFORM [힘 증가 {TB_SUM_VALUE(ARG,TCV_힘)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_지성) > 0
    SETCOLOR 0x11FF11
    PRINTFORM [지성 증가 {TB_SUM_VALUE(ARG,TCV_지성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_속도) > 0
    SETCOLOR 0x11FF11
    PRINTFORM [속도 증가 {TB_SUM_VALUE(ARG,TCV_속도)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_인내) > 0
    SETCOLOR 0x11FF11
    PRINTFORM [인내 증가 {TB_SUM_VALUE(ARG,TCV_인내)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_운) > 0
    SETCOLOR 0x11FF11
    PRINTFORM [운 증가 {TB_SUM_VALUE(ARG,TCV_운)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_물리내성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [물리내성 감소 {TB_SUM_VALUE(ARG,TCV_물리내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_화염내성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [화염내성 감소 {TB_SUM_VALUE(ARG,TCV_화염내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_빙결내성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [빙결내성 감소 {TB_SUM_VALUE(ARG,TCV_빙결내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_전격내성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [전격내성 감소 {TB_SUM_VALUE(ARG,TCV_전격내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_질풍내성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [질풍내성 감소 {TB_SUM_VALUE(ARG,TCV_질풍내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_마력내성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [마력내성 감소 {TB_SUM_VALUE(ARG,TCV_마력내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_수격내성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [수격내성 감소 {TB_SUM_VALUE(ARG,TCV_수격내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_정신내성) < 0
    SETCOLOR 0xDC143C
    PRINTFORM [정신내성 감소 {TB_SUM_VALUE(ARG,TCV_정신내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_물리내성) > 0
    SETCOLOR 0x3232CF
    PRINTFORM [물리내성 증가 {TB_SUM_VALUE(ARG,TCV_물리내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_화염내성) > 0
    SETCOLOR 0x3232CF
    PRINTFORM [화염내성 증가 {TB_SUM_VALUE(ARG,TCV_화염내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_빙결내성) > 0
    SETCOLOR 0x3232CF
    PRINTFORM [빙결내성 증가 {TB_SUM_VALUE(ARG,TCV_빙결내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_전격내성) > 0
    SETCOLOR 0x3232CF
    PRINTFORM [전격내성 증가 {TB_SUM_VALUE(ARG,TCV_전격내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_질풍내성) > 0
    SETCOLOR 0x3232CF
    PRINTFORM [질풍내성 증가 {TB_SUM_VALUE(ARG,TCV_질풍내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_마력내성) > 0
    SETCOLOR 0x3232CF
    PRINTFORM [마력내성 증가 {TB_SUM_VALUE(ARG,TCV_마력내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_수격내성) > 0
    SETCOLOR 0x3232CF
    PRINTFORM [수격내성 증가 {TB_SUM_VALUE(ARG,TCV_수격내성)}] 
ENDIF
IF TB_SUM_VALUE(ARG,TCV_정신내성) > 0
    SETCOLOR 0x3232CF
    PRINTFORM [정신내성 증가 {TB_SUM_VALUE(ARG,TCV_정신내성)}] 
ENDIF
IF TB_MAX_VALUE(ARG,TCV_은신) > 0
    SETCOLOR 0xE0E0E0
    PRINTFORM [은신 {TB_MAX_VALUE(ARG,TCV_은신)}] 
ENDIF
RESETCOLOR

;TextbungStatus
@TBS거리표시
PRINTFORML [나:{ARG능력치(T_대상1,"이동력"),3}m/턴] [서로간의 거리 : {TB_거리_은신()}m] [적:{ARG능력치(T_대상2,"이동력"),3}m/턴]

@TBS위치관계표시
#DIM DYNAMIC 칸당값
#DIM DYNAMIC 이미표시,2
칸당값 = TB_위치값한계 / 100

PRINT [
FOR LOCAL,0,99
    IF INRANGE(TB_위치(T_대상1,99) , LOCAL * 칸당값 , (LOCAL+1) * 칸당값) && INRANGE(TB_위치(T_대상2,TB_MAX_VALUE(T_대상1,TCV_은신간파)) , LOCAL * 칸당값 , (LOCAL+1) * 칸당값)
        SETCOLOR 0XF0F0F0
        PRINT @
        RESETCOLOR
        이미표시:0 = 1
        이미표시:1 = 1
    ELSEIF INRANGE(TB_위치(T_대상1,99) , LOCAL * 칸당값 , (LOCAL+1) * 칸당값) && !이미표시:0
        SETCOLOR 0XF0F000
        PRINT 나
        RESETCOLOR
        이미표시:0 = 1
    ELSEIF INRANGE(TB_위치(T_대상2) , LOCAL * 칸당값 , (LOCAL+1) * 칸당값) && !이미표시:1
        SETCOLOR 0XF02222
        PRINT 적
        RESETCOLOR
        이미표시:1 = 1
    ELSE
        PRINT .
    ENDIF
NEXT
PRINTL ]
