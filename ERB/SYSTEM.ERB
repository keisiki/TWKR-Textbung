;FileName_SYSTM.ERB -------------------------------- Rev1. 00
;뉴 게임 처리
;CALL		SYSTEM
;ARG		VOID
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@EVENTFIRST
;타겟·어시스턴트 초기화
FLAG:경고장사용 = 1
TARGET = 0
ASSI = 0

PBAND = 12

CALL MAKE_ALL_CLASS_LIST
;Default 옵션
CALL DEFAULT_OPTION

CALL ADD_ALL_CHARACTERS
;MASTER 생성
CALL CUSTOM_CHARAMAKE(MASTER)
;자지 있어라면 발기치 세트
IF TALENT:MASTER:2 & 2
	MAXBASE:MASTER:5 = 1500
	CALL TINKO_DECIDE(MASTER)
ENDIF
MAXBASE:MASTER:TSP = 100
BASE:MASTER:TSP = 100

;초기 지점 설정

FOR LOCAL, 0, CHARANUM
	;개시 위치
	CFLAG:LOCAL:현재위치 = CFLAG:LOCAL:초기위치
	;복장
	CALL SELECT_CLOTHES(LOCAL, "오늘의 의상")
	CALL CTRL_CLOTHES_SET(LOCAL, "현재 의상의 변경_평상복")
	CALL CLOTHES_SETTING_TRAIN(LOCAL)
	CALL 속옷확인리셋(LOCAL)
	SIF !EXP:LOCAL:키스경험
		TALENT:LOCAL:키스미경험 = 1
NEXT

;MASTER 기상시간 세트(7시)
TIME:3 = 420

CALL KAISYONASI

;MASTER 수면중 플래그 ON
CALL SET_SLEEP(1, MASTER, 0)

CALL SET_NOUMIN
CALL SET_MAINHOME
CALL VIRGIN_SET

CALL SET_CHARISMA("NEW")
;CALL CHARA_CUSTOM
SIF !CM_LIMIT
	CM_LIMIT = 100
;일자 1 일째
DAY = 1
DAY:2 = 1
DAY:3 = 1
FLAG:술벌레 = 1

FLAG:그림표시 = 1
FLAG:AA표시 = 1
FLAG:자식묘사 = 1

;욕구불만도의 초기설정
FOR LOCAL, 1, CHARANUM
	CFLAG:LOCAL:욕구불만도 = RAND:500
NEXT
;의뢰：편지의 행선지 처리
CALL SETUP_ALL_LETTERS
FOR LOCAL,1,CHARANUM
	IF TALENT:LOCAL:스침
		RANDOM_CHARANUM = LOCAL
		BREAK
	ENDIF
NEXT

;본체버전을 기록
SAVESTR:본체버전 = %eraTW_Version%

CALL NEWGAME_BONUS

;SYSTEMCALL to SHOW_SHOP

CALL 시작소지금설정
BEGIN SHOP

@EVENTLOAD
GETTIME
DEBUGPRINTFORML {RESULT / 10000000000000}년 {(RESULT / 100000000000) % 100}월 {(RESULT / 1000000000) % 100}일 {(RESULT / 10000000) % 100}시야
CALL ROOMSETTING
CALL VERSION_UP
SIF CFLAG:MASTER:312
	TIME:3 = CFLAG:MASTER:312
CFLAG:MASTER:312 = 0
CALL MAKE_ALL_CLASS_LIST
;의뢰：편지의 행선지 처리
CALL SETUP_ALL_LETTERS
FOR LOCAL,1,CHARANUM
	IF TALENT:LOCAL:스침
		RANDOM_CHARANUM = LOCAL
		BREAK
	ENDIF
NEXT


@VIRGIN_SET
PRINTL 게임 개시 앞에 각 캐릭터의 처녀·비처녀를 변경할 수 있습니다.
DRAWLINE
PRINTL [0] 설정 종료
PRINTL [1] 개별 설정
PRINTL [2] 당연히 전원 처녀지
PRINTL [3] 환상소녀는 오래 사니까 경험이 풍부해
PRINTL [4] 오히려 전원 걸레야
PRINTL [5] 전원 어린 여자아이야
PRINTL [6] 전원 동물귀야
PRINTL [7] 전원 자지가 나 있어
PRINTL [8] 전원 처녀 비치야
PRINTL [9] 전원 섹스가 뭔지도 몰라
PRINTL [10] 전원 섹스에 미쳐있어
PRINTL [11] 초기화
$LOOP
INPUT
SELECTCASE RESULT
	CASE 0
		PRINTW 설정을 종료합니다.
		RETURN
	CASE 1
		CALL SET_VIRGINITY
	CASE 2
		FOR LOCAL, 1, CHARANUM
			CALL SET_VIRGIN(LOCAL)
		NEXT
		PRINTW 이런 처녀 요리사를 봤나!
		PRINTW 전원 처녀로 만들었습니다.
	CASE 3
		FOR LOCAL, 1, CHARANUM
			TALENT:LOCAL:처녀 = 0
			SIF TALENT:LOCAL:성별기호 == 1
				TALENT:LOCAL:성별기호 = 0
			EXP:LOCAL:V경험 = MAX(EXP:LOCAL:V경험, 50)
			ABL:LOCAL:V감각 = MAX(ABL:LOCAL:V감각, 2)
			ABL:LOCAL:허리 = MAX(ABL:LOCAL:허리, 2)
			EXP:LOCAL:V성교경험 = MAX(EXP:LOCAL:V경험, 50)
			EXP:LOCAL:V확장경험 = MAX(EXP:LOCAL:V확장경험, 3)
			EXP:LOCAL:정액경험 = MAX(EXP:LOCAL:정액경험, 10)
		NEXT
		PRINTW 전원 비처녀로 만들었습니다.
	CASE 4
		FOR LOCAL, 1, CHARANUM
			CALL SET_YARIMAN(LOCAL)
		NEXT
		PRINTW 전원 걸레로 만들었습니다.
	CASE 5
		FOR LOCAL, 1, CHARANUM
			CALL SET_LOLI(LOCAL)
		NEXT
		IF TALENT:MASTER:형상 < 6
			PRINTFORML 가끔은 로리콘도 좋더라!
			PRINTFORML 
			PRINTW 전원 유녀로 만들었습니다.
		ELSE
			PRINTFORML 변태 새끼.
			PRINTFORML 
			PRINTW 전원 유녀로 만들었습니다.
		ENDIF
	CASE 6
		FOR LOCAL, 1, CHARANUM
			TALENT:LOCAL:143 = 1
		NEXT
		
		PRINTW 전원 동물귀로 만들었습니다. 발정기가 된다면...
	CASE 7
		FOR LOCAL, 1, CHARANUM
			TALENT:LOCAL:2 = 3
			TALENT:LOCAL:형상 = 3
			MAXBASE:LOCAL:5 = MAX(1500, MAXBASE:LOCAL:5)
			MAXBASE:LOCAL:정력 = MAX(1000, MAXBASE:LOCAL:정력)
		NEXT
		PRINTFORMW 전원 후타나리로 만들었습니다.
	CASE 8
		PRINTFORMW 따지는 게 많은 놈이네.
		FOR LOCAL, 1, CHARANUM
			TALENT:LOCAL:처녀 = 1
			SIF TALENT:LOCAL:성별기호 == 1
				TALENT:LOCAL:성별기호 = 0
			EXP:LOCAL:V경험 = 0
			ABL:LOCAL:V감각 = 0
			ABL:LOCAL:욕망 = MAX(3, ABL:LOCAL:욕망)
			EXP:LOCAL:V성교경험 = 0
			EXP:LOCAL:V확장경험 = 0
			EXP:LOCAL:정액경험 = 0
			EXP:LOCAL:키스경험 = 0
			TALENT:LOCAL:걸레 = 1
			TALENT:LOCAL:키스미경험 = 1
			TALENT:LOCAL:정조 = -1
		NEXT
		PRINTW 전원 처녀 비치로 만들었습니다.
	CASE 9
		FOR LOCAL, 1, CHARANUM
			CALL SET_VIRGIN(LOCAL)
			TALENT:LOCAL:무지 = 1
		NEXT
		PRINTW 코토히메 씨 여기예요
		PRINTW 전원 처녀에다가 지식도 없게 만들었습니다.
	CASE 10
		CALL MAKE_HENTAI(0)
		PRINTW 전원 욕망에 미쳐있게 만들었습니다. 행운을 빌어요 (웃음)
	CASE 11
		FOR LOCAL, 1, CHARANUM
			CALL RESET_CHARA(LOCAL)
		NEXT
		PRINTFORMW 전원 초기 설정으로 되돌렸습니다.
	CASE -1
		CALL MAKE_HENTAI(1)
		PRINTW 너는 이미 죽어있다.
	CASE -2
		CALL MAKE_HENTAI(2)
		PRINTW 진심으로?
	CASE -3
		CALL MAKE_HENTAI(3)
		RETURN
	CASEELSE
		GOTO LOOP
ENDSELECT
RESTART

@MAKE_HENTAI(ARG)
FOR LOCAL, 1, CHARANUM
	CFLAG:LOCAL:호감도 = 200
	ABL:LOCAL:욕망 = MAX(30, ABL:LOCAL:욕망)
	ABL:LOCAL:순종 = MAX(10, ABL:LOCAL:순종)
	ABL:LOCAL:자위중독 = MAX(5, ABL:LOCAL:자위중독)
	ABL:LOCAL:C감각 = MAX(3, ABL:LOCAL:C감각)
	ABL:LOCAL:V감각 = MAX(3, ABL:LOCAL:V감각)
	ABL:LOCAL:A감각 = MAX(3, ABL:LOCAL:A감각)
	ABL:LOCAL:B감각 = MAX(3, ABL:LOCAL:B감각)
	ABL:LOCAL:M감각 = MAX(3, ABL:LOCAL:M감각)
	TALENT:LOCAL:자위중독 = 1
	TALENT:LOCAL:도착적 = 1
	TALENT:LOCAL:쾌감응답 = 1
	TALENT:LOCAL:정조 = -1
	TALENT:LOCAL:젖기쉬움 = 1
	TALENT:LOCAL:성별기호 = -1
	TALENT:LOCAL:악취내성 = 1
NEXT

IF ARG > 0
	FOR LOCAL, 1, CHARANUM
		CFLAG:LOCAL:호감도 = 500
		TALENT:LOCAL:악취내성 = 2
		ABL:LOCAL:욕망 = MAX(35, ABL:LOCAL:욕망)
		ABL:LOCAL:순종 = MAX(15, ABL:LOCAL:순종)
		ABL:LOCAL:자위중독 = MAX(10, ABL:LOCAL:자위중독)
		MAXBASE:LOCAL:체력 = MAX(2250, MAXBASE:LOCAL:체력)
		MAXBASE:LOCAL:기력 = MAX(1750, MAXBASE:LOCAL:기력)
		MARK:LOCAL:쾌락각인 = 1
		
		BASE:LOCAL:체력 = MAXBASE:LOCAL:체력
		BASE:LOCAL:기력 = MAXBASE:LOCAL:기력
	NEXT
ENDIF

IF ARG > 1
	FOR LOCAL, 1, CHARANUM
		CFLAG:LOCAL:호감도 = 1000
		TALENT:LOCAL:악취내성 = 3
		ABL:LOCAL:욕망 = MAX(45, ABL:LOCAL:욕망)
		ABL:LOCAL:순종 = MAX(25, ABL:LOCAL:순종)
		ABL:LOCAL:자위중독 = MAX(20, ABL:LOCAL:자위중독)
		MAXBASE:LOCAL:체력 = MAX(3500, MAXBASE:LOCAL:체력)
		MAXBASE:LOCAL:기력 = MAX(2500, MAXBASE:LOCAL:기력)
		TALENT:LOCAL:즉각함락 = 1
		MARK:LOCAL:쾌락각인 = 2
		
		BASE:LOCAL:체력 = MAXBASE:LOCAL:체력
		BASE:LOCAL:기력 = MAXBASE:LOCAL:기력
	NEXT
ENDIF

IF ARG > 2
	FOR LOCAL, 1, CHARANUM
		ABL:LOCAL:욕망 = MAX(99, ABL:LOCAL:욕망)
		TALENT:LOCAL:애욕 = 1
		TALENT:LOCAL:섹프 = 1
		CFLAG:LOCAL:호감도 = 3000
		EXP:LOCAL:절정경험 = 500
		MAXBASE:LOCAL:체력 = MAX(5000, MAXBASE:LOCAL:체력)
		MAXBASE:LOCAL:기력 = MAX(3500, MAXBASE:LOCAL:기력)
		MARK:LOCAL:쾌락각인 = 3
		
		BASE:LOCAL:체력 = MAXBASE:LOCAL:체력
		BASE:LOCAL:기력 = MAXBASE:LOCAL:기력
	NEXT
ENDIF

@SET_VIRGINITY
#DIM CHARA_ID
FOR CHARA_ID, 1, CHARANUM
	SIF TALENT:CHARA_ID:처녀
		SETCOLOR C_PINK
	SIF TALENT:CHARA_ID:걸레
		SETCOLOR C_P_BLUE
	PRINTFORMLC [{CHARA_ID, 3}] %CALLNAME:CHARA_ID%
	RESETCOLOR
NEXT
PRINTL 　
DRAWLINE
PRINTL [999] 설정 종료
DO
	INPUT
	CHARA_ID = RESULT
	SELECTCASE CHARA_ID
	CASE 999
		PRINTW 개별 설정을 종료합니다.
		RETURN
	CASE 1 TO CHARANUM
		BREAK
	CASEELSE
	ENDSELECT
LOOP 1

IF TALENT:CHARA_ID:걸레
	IF CSVTALENT(CHARA_ID, GETNUM(TALENT, "처녀")) == 1
		PRINTFORMW %CALLNAME:CHARA_ID%의 능력을 초기 설정으로 되돌립니다
		CALL RESET_CHARA(CHARA_ID)
	ELSE
		PRINTFORMW %CALLNAME:CHARA_ID%를 처녀로 만듭니다
		CALL SET_VIRGIN(CHARA_ID)
	ENDIF
ELSEIF TALENT:CHARA_ID:처녀
	IF CSVTALENT(CHARA_ID, GETNUM(TALENT, "처녀")) == 0
		PRINTFORMW %CALLNAME:CHARA_ID%의 능력을 초기 설정으로 되돌립니다
		CALL RESET_CHARA(CHARA_ID)
	ELSE
		PRINTFORMW %CALLNAME:CHARA_ID%를 비처녀로 만듭니다
		TALENT:CHARA_ID:처녀 = 0
	ENDIF
ELSE
	PRINTFORMW %CALLNAME:CHARA_ID%를 걸레로 만듭니다
	CALL SET_YARIMAN(CHARA_ID)
ENDIF
RESTART

@SET_VIRGIN(ARG)
TALENT:ARG:처녀 = 1

CFLAG:ARG:처녀상실기념일=0
CSTR:ARG:첫키스위치=0
CSTR:ARG:처녀상실위치=0
CSTR:ARG:A처녀상실위치=0
CSTR:ARG:첫키스상실이력=0
CSTR:ARG:처녀상실이력=0
CSTR:ARG:애널처녀상실이력=0
CFLAG:ARG:좋아하는체위=0
CFLAG:ARG:애널개발허가=0
CFLAG:ARG:처녀상실기념일=0
CFLAG:ARG:처녀상실대상=0
CFLAG:ARG:처녀상실상대=0
CFLAG:ARG:동정상실기념일=0
CFLAG:ARG:동정상실대상=0
CFLAG:ARG:애널처녀상실기념일=0
CFLAG:ARG:애널처녀상실대상=0
CFLAG:ARG:애널처녀상실상대=0
CFLAG:ARG:첫키스상실기념일=0
CFLAG:ARG:첫키스상실상대=0
CFLAG:ARG:첫키스상실대상=0
CFLAG:ARG:누계질내정액=0
CFLAG:ARG:누계애널정액=0
CFLAG:ARG:누계정음=0
CFLAG:ARG:누계뿌려짐=0


EXP:ARG:C경험 = 0
EXP:ARG:B경험 = 0
EXP:ARG:V경험 = 0
EXP:ARG:A경험 = 0
ABL:ARG:V감각 = 0
ABL:ARG:A감각 = 0
EXP:ARG:V성교경험 = 0
EXP:ARG:V확장경험 = 0
EXP:ARG:A성교경험 = 0
EXP:ARG:A확장경험 = 0
EXP:ARG:수음경험 = 0
EXP:ARG:펠라티오경험 = 0
EXP:ARG:파이즈리경험 = 0
EXP:ARG:키스경험 = 0
EXP:ARG:봉사쾌락경험 = 0
EXP:ARG:애정경험 = 0
EXP:ARG:고통쾌락경험 = 0
EXP:ARG:가학쾌락경험 = 0
EXP:ARG:노출쾌락경험 = 0
EXP:ARG:긴박경험 = 0
EXP:ARG:절정경험 = 0
EXP:ARG:사정경험 = 0
EXP:ARG:분유경험 = 0
EXP:ARG:방뇨경험 = 0
EXP:ARG:정액경험 = 0
EXP:ARG:정액경험 = 0
EXP:ARG:출산경험 = 0
TALENT:ARG:키스미경험 = 1
TALENT:ARG:걸레 = 0
TALENT:ARG:성별기호 = CSVTALENT(ARG, 81)
TALENT:ARG:정조 = CSVTALENT(ARG, 30)
ABL:ARG:허리 = CSVABL(ARG, GETNUM(ABL, "허리"))
ABL:ARG:욕망 = CSVABL(ARG, GETNUM(ABL, "욕망"))

@SET_YARIMAN(ARG)
TALENT:ARG:처녀 = 0
SIF TALENT:ARG:성별기호 == 1
	TALENT:ARG:성별기호 = 0
EXP:ARG:V경험 = MAX(EXP:ARG:V경험, 100)
ABL:ARG:V감각 = MAX(ABL:ARG:V감각, 3)
ABL:ARG:허리 = MAX(ABL:ARG:허리, 3)
ABL:ARG:욕망 = 3
EXP:ARG:V성교경험 = MAX(EXP:ARG:V경험, 100)
EXP:ARG:V확장경험 = MAX(EXP:ARG:V확장경험, 3)
EXP:ARG:정액경험 = MAX(EXP:ARG:정액경험, 50)
TALENT:ARG:걸레 = 1
TALENT:ARG:정조 = -1

@SET_LOLI(ARG)
TALENT:ARG:가슴사이즈 = MAX(TALENT:ARG:가슴사이즈 - 2, -2)
TALENT:ARG:체형 = -2

;강하게뉴게임에서도 사용된다
;CFLAG의 리셋는 인계에 지장이 있으므로 금지
@RESET_CHARA(ARG)
FOR LOCAL, 0, VARSIZE("TALENTNAME")
	TALENT:ARG:LOCAL = CSVTALENT(ARG, LOCAL)
NEXT
FOR LOCAL, 0, VARSIZE("EXPNAME")
	EXP:ARG:LOCAL = CSVEXP(ARG, LOCAL)
NEXT
FOR LOCAL, 0, VARSIZE("ABLNAME")
	ABL:ARG:LOCAL = CSVABL(ARG, LOCAL)
NEXT
FOR LOCAL, 0, VARSIZE("EXPNAME")
	EXP:ARG:LOCAL = CSVEXP(ARG, LOCAL)
NEXT
FOR LOCAL, 0, VARSIZE("BASENAME")
	BASE:ARG:LOCAL = CSVBASE(ARG, LOCAL)
	MAXBASE:ARG:LOCAL = BASE:ARG:LOCAL
NEXT
CFLAG:ARG:처녀상실기념일=0
CSTR:ARG:첫키스위치=
CSTR:ARG:처녀상실위치=
CSTR:ARG:A처녀상실위치=
CSTR:ARG:첫키스상실이력=
CSTR:ARG:처녀상실이력=
CSTR:ARG:애널처녀상실이력=
CFLAG:ARG:좋아하는체위=0
CFLAG:ARG:애널개발허가=0
CFLAG:ARG:처녀상실기념일=0
CFLAG:ARG:처녀상실대상=0
CFLAG:ARG:처녀상실상대=0
CFLAG:ARG:동정상실기념일=0
CFLAG:ARG:동정상실대상=0
CFLAG:ARG:애널처녀상실기념일=0
CFLAG:ARG:애널처녀상실대상=0
CFLAG:ARG:애널처녀상실상대=0
CFLAG:ARG:첫키스상실기념일=0
CFLAG:ARG:첫키스상실상대=0
CFLAG:ARG:첫키스상실대상=0
CFLAG:ARG:누계질내정액=0
CFLAG:ARG:누계애널정액=0
CFLAG:ARG:누계정음=0
CFLAG:ARG:누계뿌려짐=0


@NEWGAME_BONUS
SETCOLOR 103,228,126
PRINTFORML 【뉴 게임 특전】
RESETCOLOR
$TOKUTEN
PRINTFORML 좋아하는 것을 선택해 주세요
CALL ASK_M("【붉은실】", 1 ,"【절륜】", 1,"【수수께끼의매력】", 1, "【만능잉태】", 1, "【익스텐드】", 1,"【습득 빠름】", 1)
SELECTCASE RESULT
	CASE 0
		PRINTFORML 데이트 중 상대와의 상성을 올릴수 있는 특성입니다.
		PRINTFORML 괜찮겠습니까?
		CALL ASK_YN
		IF !RESULT
			SETBIT FLAG:호감도보너스취득상황, 8
			TALENT:MASTER:붉은실 = 1
			PRINTFORMW 【붉은실】을 얻었다!
		ELSE
			GOTO TOKUTEN
		ENDIF
	CASE 1
		PRINTFORML 사정시 체력, 기력이 감소하지 않고 사정량이 2배 증가합니다.
		PRINTFORML 괜찮겠습니까?
		CALL ASK_YN
		IF !RESULT
			SETBIT FLAG:팬티보너스취득상황, 8
			TALENT:MASTER:절륜 = 1
			PRINTFORMW 【절륜】을 얻었다!
		ELSE
			GOTO TOKUTEN
		ENDIF
	CASE 2
		PRINTFORML 대부분의 커맨드에 보정이 붙으며 호감도 상승량이 증가합니다.
		PRINTFORML 괜찮겠습니까?
		CALL ASK_YN
		IF !RESULT
			SETBIT FLAG:함락보너스취득상황, 3
			TALENT:MASTER:수수께끼의매력 = 1
			PRINTFORMW 【수수께끼의매력】을 얻었다!
		ELSE
			GOTO TOKUTEN
		ENDIF
	CASE 3
		PRINTFORML 어떤 종족이라도 임신시키기 쉬워집니다.
		PRINTFORML 괜찮겠습니까?
		CALL ASK_YN
		IF !RESULT
			SETBIT FLAG:잉태보너스취득상황, 1
			TALENT:MASTER:만능잉태 = 1
			PRINTFORMW 【만능잉태】를 얻었다!
		ELSE
			GOTO TOKUTEN
		ENDIF
	CASE 4
		PRINTFORML 탄막승부시 잔기가 1개 증가합니다.
		PRINTFORML 괜찮겠습니까?
		CALL ASK_YN
		IF !RESULT
			SETBIT FLAG:탄막승부보너스취득상황, 5
			TALENT:MASTER:익스텐드 = 1
			PRINTFORMW 【익스텐드】를 얻었다!
		ELSE
			GOTO TOKUTEN
		ENDIF
	CASE 5
		PRINTFORML 기교 및 성기술 ABL이 쉽게 오릅니다.
		PRINTFORML 괜찮겠습니까?
		CALL ASK_YN
		IF !RESULT
			SETBIT FLAG:기술보너스취득상황, 6
			TALENT:MASTER:습득속도 = 1
			PRINTFORMW 【습득 빠름】를 얻었다!
		ELSE
			GOTO TOKUTEN
		ENDIF
ENDSELECT